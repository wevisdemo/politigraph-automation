name: Scrape & Update Bills / BillEvents

on:
  workflow_dispatch:
  schedule:
    - cron: '0 17 * * SUN'  # Every Sunday at 17:00 UTC(1:00 AM GMT+7)

permissions:
  contents: 'read'
    
jobs:
  run_python_script:
    runs-on: ubuntu-latest

    env:
      MODE: "dev"
      ACTIONS_RUNNER_DEBUG: true

    steps:
      - uses: actions/checkout@v3  # Setup

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10.11'

      - name: Scrap & Update Bills
        run: uv run scripts/scrape_bills.py
        env:
          POLITIGRAPH_SUBSCRIBTION_ENDPOINT: "${{ secrets.POLITIGRAPH_SUBSCRIBTION_ENDPOINT }}"
          POLITIGRAPH_TOKEN: "${{ secrets.POLITIGRAPH_TOKEN }}"